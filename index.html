<!doctype html><html lang=ja dir=auto><head><meta name=generator content="Hugo 0.110.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tbistr blog</title><meta name=description content="tbistr's blog"><meta name=author content="tbistr"><link rel=canonical href=https://tbistr.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><link rel=icon href=https://tbistr.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tbistr.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tbistr.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://tbistr.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://tbistr.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://tbistr.github.io/index.xml><link rel=alternate type=application/json href=https://tbistr.github.io/index.json><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-5JG1SFWT3X"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5JG1SFWT3X",{anonymize_ip:!1})}</script><meta property="og:title" content="Tbistr blog"><meta property="og:description" content="tbistr's blog"><meta property="og:type" content="website"><meta property="og:url" content="https://tbistr.github.io/"><meta property="og:image" content="https://tbistr.github.io/images/coara.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tbistr.github.io/images/coara.jpg"><meta name=twitter:title content="Tbistr blog"><meta name=twitter:description content="tbistr's blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Tbistr blog","url":"https://tbistr.github.io/","description":"tbistr\u0026#39;s blog","thumbnailUrl":"https://tbistr.github.io/favicon/favicon.ico","sameAs":["https://github.com/tbistr","https://twitter.com/jack007xx"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tbistr.github.io/ accesskey=h title="Tbistr blog (Alt + H)">Tbistr blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tbistr.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://tbistr.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://tbistr.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://tbistr.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Tbistr</h1></header><div class=entry-content><p>名古屋大学情報学研究科の院生です。</p><ul><li>個人的な記録、メモを載せます。</li></ul></div><footer class=entry-footer><div class=social-icons><a href=https://github.com/tbistr target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/jack007xx target=_blank rel="noopener noreferrer me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2>簡単にTUIが作れる！Bubble Teaのススメ(アーキテクチャ編)</h2></header><div class=entry-content><p>Bubble Teaとは Bubble Teaは、Text User Interface(TUI)を作成するためのGo言語のライブラリ(フレームワーク)です。 以下のようなCLIアプリケーションを、比較的簡単に作成できます。
Bubble TeaのGitHubリポジトリより引用
Bubble Teaはフレームワーク的な部分があるため、アーキテクチャを理解することが重要です。 (理解しないと使えません。) この記事では、Bubble Teaのアーキテクチャについて紹介します。
Elmアーキテクチャ Bubble Teaの中心となる考え方は、Elmアーキテクチャに基づいています。 Elmアーキテクチャは、Elmという関数型のAltJS言語で考案された、Webフロントエンドのアーキテクチャです。
Elmアーキテクチャは、以下の3つの要素から構成されます。
Model: アプリケーションの状態を表すデータ View: Modelの状態を表示するための関数(ElmではHTMLを生成) Update: Modelを更新するための関数 ユーザが何か入力したり、イベントが発生すると、ランタイムはUpdateを呼び出します。 このとき渡されるmsgは、入力やイベントを表すデータ構造です。 Updateはmsgの種類・内容に応じてModelを更新します。 (Updateはイベントハンドラのようなものですね。)
Update, Viewが純粋関数であることにより、テストが容易になったりというメリットがありそうです。 この辺は関数型っぽいですね。
Bubble Teaのアーキテクチャ Bubble TeaはElmアーキテクチャをCLIのためにGo言語で実装したものと考えてもらってOKです。
Bubble Teaアプリとして実行するためには、以下のintefaceが実装されている必要があります。
type Model interface { Init() Cmd Update(Msg) (Model, Cmd) View() string } Viewを見ると、ElmのViewと同じようにModelから文字列(CUI)を生成する関数であることがわかります。 一方、UpdateはElmのものと少し異なり、Msgを受け取ってModelとCmdを返しています。 Modelを返しているのは、Updateが値呼びの関数であるためです。 変更後のModelを返すことでModelの変更を実現しています。
CmdとMsg Cmd、Msgの定義は以下の通りです。
type Msg interface{} type Cmd func() Msg Msgはinterface{}なので、何でもアリです。 CmdはMsgを返す関数なので、これも何でもアリの関数になります。 型にはほぼ情報が無いですね。
実際には、Cmdは主にI/O処理を実行するために使われます。 Updateから返されたCmdは、Bubble Teaランタイムによってgroutineとして非同期に実行されます。
Msgは、Updateの引数になっていることからもわかるように、ユーザの入力やイベントを表すデータです。...</p></div><footer class=entry-footer><span title='2023-08-14 20:58:51 +0000 UTC'>8月 14, 2023</span>&nbsp;·&nbsp;2 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to 簡単にTUIが作れる！Bubble Teaのススメ(アーキテクチャ編)" href=https://tbistr.github.io/posts/tech/introduce_bubbletea/></a></article><article class=post-entry><header class=entry-header><h2>Linux Short Course</h2></header><div class=entry-content><p>Introduction なんだか、バイト先や研究室でLinuxの基本知識的な部分を聞かれたり、教えたりすることが多い。 最近、Linux関連の良い本が増えていて、初級者～中級者くらいまで一気に駆け抜けられる環境が整いつつある。 そこで、Linuxをユーザとして、開発者として使うための(個人的)最短ルートを考えてみた。
まだまだブラッシュアップ段階で、特にWebの資料について触れられていないので、随時更新していく予定。
ユーザとして(初級編) ユーザとしての入門「新しいLinuxの教科書」 「新しいLinuxの教科書」は、まさにLinuxの教科書的な存在で、「ディストリビューションってなに?」なところから丁寧に解説してくれて、Linuxの基本的な使い方を学べる。 とりあえず、Linux触ったことない人にはこれを読んで欲しい。
新しいLinuxの教科書
シェル入門 「シェルスクリプト基本リファレンス」 「新しいLinuxの教科書」では、当然シェルの基本的な使い方やメジャーなコマンドについては紹介されている。 一方で、少し発展的な使い方やシェル(bash)自体の機能について網羅的に紹介されているわけではない。
シェルスクリプト基本リファレンスには、シェル自体の機能から応用的なコマンドまで幅広く辞書的に載っている。 当然、manコマンドを使って調べることもできるが、予めパラパラと見ておくことで、「この機能はたしかコマンドとして提供されたな」みたいなあたりを付けることができる。 「できる、できない」の判断がついていると、Webで検索する際にも迷子になりにくい。
(最近では、ChatGPTに聞けばほとんどのコマンド、オプションを教えてくれるため、わざわざ逆引き的に覚えておく必要はないかもしれない)
シェルスクリプト基本リファレンス
開発者、管理者として(初級編) Linuxの上でソフトを開発したり、Linuxサーバにアプリをデプロイしたりする場合、ユーザとしての知識だけでは足りないことがある。 例えば、Docker(仮想化技術)を使う場合、ファイルシステムやネットワークについての基本的な知識が必要になる。
Linuxの裏側に入門する「［試して理解］Linuxのしくみ―実験と図解で学ぶOS、仮想マシン、コンテナの基礎知識」 この本はLinuxの中身、特にカーネルと呼ばれる根幹部分で何をしているかを知るための入門書である。 最近のニーズに対応するため、仮想マシン、コンテナという副題がついているものの、OSとしてのLinuxの上に広がる概念、用語を初学者にもわかりやすく解説している。 (個人的には、ここ最近出たLinux関連本の中ではイチオシ)
著者の武内覚(sat)さんは、YouTubeチャンネルでもLinux関連のトピックを解説しておられて、こちらもおすすめ。 こちらは体系的というより、動画ごとにトリビアルな内容となっている。 興味のある分野から観てみることをおすすめする。
Linuxのしくみ satさんのYouTubeチャンネル
ユーザ、開発者、管理者として(中級編) ちょっと扱いに迷ったが、このレベルになるとユーザ、開発者、管理者という区分けはあまり意味がなく、どの立場においても知っておくべき内容になってくる。 よって、「中級編」としてまとめることにした。
更にシェルでできることを増やす「シェル・ワンライナー160本ノック」 この本は、シェルのコマンドを組み合わせて1行のコマンド列で何かを実現するという「ワンライナー」を中心に、コマンド、シェルの機能を学べるドリルである。 本当に160本の例題が載っており、それぞれの例題に解説、別解が丁寧に付いている。 全部通すのはかなりしんどいが、やりきると多分シェルについてはかなり理解が深まるはず。 (僕はパラパラ読みで全部手を動かしたわけではない…ハズカシイ)
シェル・ワンライナー160本ノック
最近のLinuxツールチェイン、ユースケースを知る「入門 モダンLinux」 Linuxはカスタム性が強く、ツールなどのトレンドが変わりやすい (もちろん変わらないインタフェースもあるが)。 この本では、最近のLinux周辺ツール、環境、ユーザがどんな使い方をしているか、などについて解説している。
例えば、シェルと一口に言っても、bash、zsh、fishなど様々なシェルがある。 この本には、各シェルがどんな特徴を持っているか、注意点はなにか、といったことが載っている。 また、eBPFなど最近のLinuxカーネルの機能についても解説がある。 これら最新の動向、流行りを知っておくと、Webや雑誌の技術記事に関する解像度がクリアになり、情報収集のスピードが加速度的に上がる。 そんな意味でもこの本はおすすめ。
ちなみに、この本の翻訳には先述したsatさんも関わっている。 再度になるが、satさんのYouTubeチャンネルではこの本で扱うような最新のトピックにも言及しており、本と一緒に楽しむことができる。
入門 モダンLinux
管理者としての知識を深める「スーパーユーザーなら知っておくべきLinuxシステムの仕組み」 名前のとおり、スーパーユーザ(管理者)が知っておくべきLinuxの仕組み、使い方についてかなり広範に、詳細に扱っている本である。 ぶっちゃけ、僕も読めていない節があったり、これまで紹介してきたリソースに比べて相当に難しく、実践的な内容になっている。 (正直、上級編として別枠にしても良い)
全ては理解できなくても、仮想マシンなどで手を動かしながら読み進めることで、周辺知識も含めたLinuxの理解がかなり深まる。 また、必要となってからリファレンス的に用いることも出来るので、一度パラ読みしてみることをおすすめする。
スーパーユーザーなら知っておくべきLinuxシステムの仕組み
まとめ こんな感じのルートを最近はおすすめしている。 また、シェルについて省略したこんなルートも良いかもしれない。
新しいLinuxの教科書 Linuxのしくみ 入門 モダンLinux スーパーユーザーなら知っておくべきLinuxシステムの仕組み この記事については、特にWebのリソースを中心にまだまだ漏れがありそうなので、都度更新していく予定。 なにかおすすめのリソースがあったら教えてください。...</p></div><footer class=entry-footer><span title='2023-06-16 07:05:41 +0000 UTC'>6月 16, 2023</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to Linux Short Course" href=https://tbistr.github.io/posts/tech/linux_short_course/></a></article><article class=post-entry><header class=entry-header><h2>2023年上半期に聞いてよかった曲</h2></header><div class=entry-content><p>2023年上半期良かった曲 2023年も半分過ぎましたけど、体感起きてる時間の3分の2くらいはSpotifyで音楽聞いてるので、良かった曲を40曲紹介します。 プレイリスト公開しているので、こちらから聞いてみてね。
Spotify契約していない貧乏人のためちょっとだけ聴けるリンクも貼っておきます。
本編</p></div><footer class=entry-footer><span title='2023-06-05 23:26:39 +0000 UTC'>6月 5, 2023</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to 2023年上半期に聞いてよかった曲" href=https://tbistr.github.io/posts/music/2023h1-my-best-hits/></a></article><article class=post-entry><header class=entry-header><h2>Type aliasの使い所を提案</h2></header><div class=entry-content><p>Type alias Type aliasはGo 1.9で追加された機能です。 以下のようなsyntaxで既存の型に別名を定義できます。
type aliasT = string 普通のDefined typeと何が違うのかというと、定義された型と元になる型との同一性が異なります。 具体的にDefined typeでは以下のように独自メソッドを生やすことができる一方、Type aliasにはメソッドを追加できません。
type defT string func (d defT) SomeMethod() { // これは出来る } type aliasT = string func (d aliasT) SomeMethod() { // これは出来ない! } これはaliasT型がstringと完全に同じとみなされているからで、以下のようなコードはコンパイルが通ります。
type aliasT = string func f() string { var a aliasT return a } 使い所 導入経緯的には、大規模コードのAPI変更をサポートするために作られた機能だそうで、普通のコードベースだと一生体験する機会がなさそうです。 そんな感じで微妙にどこに使えば良いか迷うこの機能ですが、最近書いたコードで良さそうなユースケースを見つけました。
導入対象 対象となるプロジェクトは自作のAtCoder関連のライブラリ「atcoder-go」で、注目したい部分は以下のようなファイル群です。
atcodergo |---model // 外部に公開する構造体を定義 | |---model.go |---parse // HTMLパーサー、セレクタを使ってHTML→構造体の変換 | |---task.go | |---(etc....</p></div><footer class=entry-footer><span title='2023-03-06 21:04:34 +0000 UTC'>3月 6, 2023</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to Type aliasの使い所を提案" href=https://tbistr.github.io/posts/tech/golang_typealias/></a></article><article class=post-entry><header class=entry-header><h2>Go言語で独自エラーを実装するときの実例(ライブラリ編)</h2></header><div class=entry-content><p>概要 Goでライブラリを作るとき、呼び出し元でどのようにエラーハンドリングするか想像して実装することが出来ていますか? この記事では、minimalなサンプルを提示し、Goでの独自エラー実装について紹介します。
TODO: Asについては、僕がユースケースを理解できていないので書いていません。
前提 Goの文法は分かっているということを仮定します。
ライブラリ利用者側から見たGoのエラー処理について ご存知の通り、Goには高級?なエラー処理機構がありません。 関数が正常に終了したかどうかは、if文によって判定します。
func someFunc() error {...} err := someFunc() if err != nil { // 何か処理 } また、errorインターフェースの定義は以下のようになっていて、.Error()によって出力する文字列を作成できれば、どんなものでもerror型として扱うことが出来ます。
type error interface{ Error() string } そのため、ライブラリ作成者には独自エラーの構造体に対して、Error() stringを実装することが要求されます。
type myError struct{ // some member } func (err *myError) Error() string{ return "" } Unwrapの利用 上記のような独自エラーには、エラーが起こった原因となるエラーが何か判別出来ないという欠点がありました。 (正確には、判別のための標準的なインターフェースがなかった。)
Go1.13以降、エラー原因の特定インターフェースとして、errors.Unwrap(err) errorという関数が使えます。 これによって、ライブラリ使用者はエラーを引き起こしたエラーを取得することが出来ます。
err := someFunc() if err != nil { inner := errors.Unwrap(err) fmt.Printf("内部エラーはこれ: %v", inner) } Isの利用 エラー原因特定のユースケースとして、エラー種別によって処理を分けるというケースがあります。 このとき、エラーの原因の原因の原因…のようにエラーが連鎖的にwrapされている場合、あるエラーと、その原因となったエラーの種別が同じものかを判定する必要があります。...</p></div><footer class=entry-footer><span title='2022-11-21 04:49:26 +0000 UTC'>11月 21, 2022</span>&nbsp;·&nbsp;4 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to Go言語で独自エラーを実装するときの実例(ライブラリ編)" href=https://tbistr.github.io/posts/tech/golang_error_impl/></a></article><article class=post-entry><header class=entry-header><h2>DockerComposeで環境変数のエイリアスを作りたい</h2></header><div class=entry-content><p>経緯 相変わらずDocker上のMySQLをいじっている。
MySQLサーバに対して、毎回コンテナに入ってmysqlプロンプトを出してコマンドを打つのがめんどくさいので、webベースのGUIサーバを追加することにした。 このとき、.envで指定しているMySQL用のユーザ情報について、同じ値を別の名前で環境変数として指定する必要があった。
環境 docker-composeファイルは以下の通り。
version: '3.8' services: db: container_name: db image: mysql:8.0 environment: - LANG=ja_JP.UTF-8 tty: true volumes: - type: volume source: test_volume target: /var/lib/mysql networks: - test_network volumes: test_volume: name: test_volume networks: test_network: external: true .envはこの内容。
MYSQL_DATABASE=test_database MYSQL_USER=test_user MYSQL_PASSWORD=password MYSQL_ROOT_PASSWORD=root_password 課題 今の環境に、phpmyadminというMySQLのGUIツールを新しいサービスとして導入する。 具体的に以下の内容を追加したい。
db-gui: container_name: db-gui image: phpmyadmin/phpmyadmin environment: - LANG=ja_JP.UTF-8 tty: true ports: - 8080:80 depends_on: - db networks: - test_network このとき、phpmyadminコンテナには環境変数PMA_HOSTS, PMA_USER, PMA_PASSWORDを渡して接続先と認証の情報を教える必要がある。 しかし、PMA_HOSTSはサービス名(db)を直書きすれば良いとして(networkが設定されてるので、サービス名←→アドレスができる)、他の2つの値は.envのMYSQL_USER, MYSQL_PASSWORDと同一である。...</p></div><footer class=entry-footer><span title='2022-08-23 12:10:26 +0000 UTC'>8月 23, 2022</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to DockerComposeで環境変数のエイリアスを作りたい" href=https://tbistr.github.io/posts/tech/docker-compose%E3%81%A7%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%AE%E3%82%A8%E3%82%A4%E3%83%AA%E3%82%A2%E3%82%B9%E3%82%92%E4%BD%9C%E3%82%8A%E3%81%9F%E3%81%84/></a></article><article class=post-entry><header class=entry-header><h2>MySQLのチュートリアルでコケた</h2></header><div class=entry-content><p>流れ 今作ってるbotでMySQLを使いたくなったので、使ってみる。 作ってるのはhttps://github.com/tbistr/gs-linker。
参考 MySQLのチュートリアルサイト? https://www.mysqltutorial.org/getting-started-with-mysql/ を参考にした。
環境はVagrantで作った。 Boxはbento/ubuntu-20.04。
インストール チュートリアルサイトでのインストールの手順では、 sudo mysql_secure_installationでどんなパスワードを設定しても
... Failed! Error: SET PASSWORD has no significance for user 'root'@'localhost' as the authentication method used doesn't store authentication data in the MySQL server. Please consider using ALTER USER instead if you want to change authentication parameters. のエラーで失敗する。
そのため、sudo mysql_secure_installationの前に、
sudo mysql mysql> ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '適当なパスワード'; mysql> exit を実行した。
あとは手順通り、すべてyでOK。
一応確認、
sudo mysql -u root -p mysql> show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | sys | +--------------------+ 4 rows in set (0....</p></div><footer class=entry-footer><span title='2022-08-19 13:48:10 +0000 UTC'>8月 19, 2022</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to MySQLのチュートリアルでコケた" href=https://tbistr.github.io/posts/tech/mysql_tutorial/></a></article><article class=post-entry><header class=entry-header><h2>Virtualbox Manager (GUI)が起動しないバグと解決方法</h2></header><div class=entry-content><p>概要 原因はUSBでつながっていたXInputのコントローラ。 デバイスを抜くことで解決。
状況 症状 VirtualboxのGUIが起動しない vagrant upが失敗する VBoxManage.exeコマンドに応答がない helpは表示できるが、vmのリスト等は出ない 環境 i7-12700 32gb windows11 pro virtualbox 6.1.32 chocolateyでインストール wsl, dockerがインストールされている ハイパーバイザプラットフォーム有効化済み 確認したこと、やってみたこと タスクマネージャの確認 virtualboxの再インストール vagrantの再インストール OSのクリーンインストール タスクマネージャの確認 「バックグラウンドプロセス」のタブにこの3つのプロセスが存在した。
Virtualbox Interface Virtualbox Global Interface Virtualbox Manager 本来は、Virtualbox Managerは「アプリ」のタブにあるべき。 起動を試みるたびに、Virtualbox Managerは増えていき、ゾンビプロセスになった。
virtualbox, vagrantの再インストール chocolatey版、msiインストーラ版両方試したが効果なし。
OSのクリーンインストール しばらくは問題が起きなくなったが、ある日突然再発。
原因と解決方法 VM起動時にエラーが発生し、いつもどおり原因をググっていたところ、同じような問題がOracleのフォーラムに投稿されていることに気がついた。
https://forums.virtualbox.org/viewtopic.php?t=97261
昨年10月に、このような投稿があった。
Re: GUI not appearing
Postby LeonJi » 4. Oct 2021, 04:11
I also got this problem this morning.
Finally, I found an usb device(wireless adaptor for game controller) was the root cause....</p></div><footer class=entry-footer><span title='2022-04-26 07:35:27 +0000 UTC'>4月 26, 2022</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to Virtualbox Manager (GUI)が起動しないバグと解決方法" href=https://tbistr.github.io/posts/tech/vb_usb_bug/></a></article><article class=post-entry><header class=entry-header><h2>texlive2021の最強環境を作ったよ</h2></header><div class=entry-content><p>概要 卒論のために久しぶりにTeX環境を作る必要があったので、TeX Liveがfullでインストールされたコンテナイメージを探していたのですが、無かったので作りました。 通常のインストール手順ではハマるポイントがあったのでパッケージマネージャを使わない方法でインストールしました。
devcontainer化することで、vscodeから立ち上げるだけで補完、プレビューが使えるようになっています。
devcontainer devcontainerとは、vscodeの（拡張）機能の1つで、これを利用することで用意したコンテナの中にワークスペースフォルダをマウントし、コンテナ内のコマンド、環境を使うことができます。 また、拡張機能、設定についても指定したものを使うことができます（ローカルのvscodeにはインストールされません）。 これにより、環境の分離、チーム内での共通化ができます。
参考：devcontainerのチュートリアル
ネット上に存在するTeX用Dockerイメージ ネット上には、フルインストール版、日本語に必要なモジュールに限定した版の両方について、様々なイメージが存在しています。 しかし、日本語環境がうまく入らない、texindex（フォーマッタ）が動作しないなど、日本語環境で常用するには不具合が発生しました。 執筆中に試してみたら、公式が配布しているtexlive/texliveイメージはちゃんと全部動きました。。。まあ、見なかったことにします。 また、fullと謳っていながら実際にはモジュールに不足があるイメージもあります（主に日本語関係のモジュールがない）。
制作内容 全容はGithubのリポジトリから参照できます。
tex.profile texを非対話的に（ビルド時にユーザーがオプション等を選択しない）インストールするのに必要な設定ファイルです。 今回は、このファイルによるスキーマ指定がしたかったため、aptは使わずに、ソースからインストールしています。
selected_scheme scheme-fullでfullバージョンを指定しています。
その他で肝要な部分は、option_doc 0とoption_src 0です。 fullでインストールすると、ドキュメントとソースを含むだけで2GB近く消費してしまいます。 そのため、このオプションで除外しておきます。
selected_scheme scheme-full TEXDIR /opt/texlive/2021 TEXMFCONFIG ~/.texlive2021/texmf-config TEXMFHOME ~/texmf TEXMFLOCAL /opt/texlive/texmf-local TEXMFSYSCONFIG /opt/texlive/2021/texmf-config TEXMFSYSVAR /opt/texlive/2021/texmf-var TEXMFVAR ~/.texlive2021/texmf-var binary_x86_64-darwin 0 binary_x86_64-linux 1 binary_win32 0 option_doc 0 option_src 0 option_adjustrepo 0 余談ですが、この設定ファイルの書式、TeX Liveのリファレンスにも見つけられませんでした（一度デフォルト設定でビルドすると出力されるから、それを改変しろ。ということらしい。）
Dockerfile 本体となるDocekrfileです。 ベースにはmicrosoftが公開しているdevcontainer用に設定されたイメージを使用しました。 基本的なutil系コマンドがインストール済みです。
それ以降の処理はコメントに記載してあるとおりです。
FROM mcr.microsoft.com/vscode/devcontainers/base:ubuntu-21.04 COPY tex.profile ./ # 日本のミラーサーバからTeX Live 2021をダウンロードしてくる RUN wget https://texlive....</p></div><footer class=entry-footer><span title='2022-01-14 05:20:52 +0000 UTC'>1月 14, 2022</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to texlive2021の最強環境を作ったよ" href=https://tbistr.github.io/posts/tech/tex_devcontainer/></a></article><article class=post-entry><header class=entry-header><h2>Vagrantでデスクトップ環境はいらないけど、GUIアプリを使いたい</h2></header><div class=entry-content><p>何がしたいか Vagrantで立てたVMについて、デスクトップ環境(GNOMEとかLXDEとか)を導入して、GUI環境を実現させる方法は様々な紹介されている。
しかし、デスクトップ環境の導入をすると、プロビジョニングのステップでapt-get install ubuntu-desktopなどする必要があり、めちゃめちゃ時間がかかる。
ここでは、VM内のアプリケーションをwindows上のウィンドウとして描画させることを目指す。
仕組み 用語 X Window System (X11) linuxがデファクトで使っている、ウィンドウ表示プロトコル。 X11クライアント 画面を描画してもらうアプリケーション。 今回の場合、ゲストOS上で動くアプリケーション。 X11サーバー 画面を描画する側。 今回の場合、ホストOSのウィンドウシステム。 vcXsrv 今回使うwindows向けX11サーバー。 X11サーバーは色々種類があるが、最近はこれが主流らしい。 実際の動き 下図のように、SSH経由で送信。 実践 準備 Chocolateyを使っているので、choco install vcxsrvでvcXsrvをインストール。
(https://sourceforge.net/projects/vcxsrv/ からもインストールできる)
起動すると設定項目が出る。 すべて初期設定で問題ない。
タスクバーにX11のロゴが出ていたら準備完了。(簡単！！！)
Vagrantファイルの用意 最終的に、以下のようなVagrantファイルを用意する。
Vagrant.configure("2") do |config| config.vm.box = "bento/ubuntu-20.10" config.ssh.forward_x11 = true config.vm.provision "shell", inline: &lt;&lt;-SHELL apt-get update apt-get upgrade SHELL config.vm.provision "shell", privileged: false, inline: &lt;&lt;-SHELL echo "export DISPLAY=10.0.2.2:0" >> ~/.bash_profile SHELL end そこまで解説することはないが、少しだけ。
config.ssh.forward_x11 = trueは、X11を有効化するオプション。 これをtrueに設定することで、vagrant sshで接続したときに自動でx11を転送してくれる。...</p></div><footer class=entry-footer><span title='2021-12-18 17:01:15 +0900 +0900'>12月 18, 2021</span>&nbsp;·&nbsp;1 分&nbsp;·&nbsp;tbistr</footer><a class=entry-link aria-label="post link to Vagrantでデスクトップ環境はいらないけど、GUIアプリを使いたい" href=https://tbistr.github.io/posts/tech/vagrant_x11/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://tbistr.github.io/page/2/>次へ&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://tbistr.github.io/>Tbistr blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>